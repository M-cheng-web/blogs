import{_ as s,c as a,o as n,a as l}from"./app.3f3df282.js";const C=JSON.parse('{"title":"promise","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u4ECB\u7ECD","slug":"\u4ECB\u7ECD","link":"#\u4ECB\u7ECD","children":[]},{"level":2,"title":"\u6CE8\u610F\u70B9","slug":"\u6CE8\u610F\u70B9","link":"#\u6CE8\u610F\u70B9","children":[]},{"level":2,"title":"\u9759\u6001\u65B9\u6CD5","slug":"\u9759\u6001\u65B9\u6CD5","link":"#\u9759\u6001\u65B9\u6CD5","children":[]},{"level":2,"title":"\u624B\u5199\u7B80\u6613promise","slug":"\u624B\u5199\u7B80\u6613promise","link":"#\u624B\u5199\u7B80\u6613promise","children":[]},{"level":2,"title":"promise \u4EFB\u52A1\u8C03\u5EA6","slug":"promise-\u4EFB\u52A1\u8C03\u5EA6","link":"#promise-\u4EFB\u52A1\u8C03\u5EA6","children":[]}],"relativePath":"web-basics/javascript/promise.md","lastUpdated":1670155339000}'),p={name:"web-basics/javascript/promise.md"},o=l(`<h1 id="promise" tabindex="-1">promise <a class="header-anchor" href="#promise" aria-hidden="true">#</a></h1><h2 id="\u4ECB\u7ECD" tabindex="-1">\u4ECB\u7ECD <a class="header-anchor" href="#\u4ECB\u7ECD" aria-hidden="true">#</a></h2><p>\u4E3B\u8981\u662F\u4E3A\u4E86\u89E3\u51B3\u56DE\u8C03\u5730\u72F1(\u591A\u4E2A\u4E32\u8054\u7684\u5F02\u6B65\u64CD\u4F5C),\u5728\u65E5\u5E38\u5DE5\u4F5C\u4E2D\u4E3B\u8981\u662F\u914D\u5408axios\u8BF7\u6C42\u4EE5\u53CAvuex\u4E2D\u7684\u4E00\u4E9B\u64CD\u4F5C</p><h2 id="\u6CE8\u610F\u70B9" tabindex="-1">\u6CE8\u610F\u70B9 <a class="header-anchor" href="#\u6CE8\u610F\u70B9" aria-hidden="true">#</a></h2><ul><li>new promise\u5185\u7684\u8BED\u6CD5\u662F\u540C\u6B65\u7684,\u5728.then()\u4E2D\u7684\u8BED\u53E5\u624D\u662F\u5F02\u6B65\u7684,\u4E14\u662F\u5FAE\u961F\u5217</li><li>.then()\u8FD4\u56DE\u72B6\u6001\u4E4B\u524Dnew promise\u4F1A\u8FD4\u56DE\u4E00\u4E2Apromise\u5B9E\u4F8B,\u4F46\u662F\u8FD9\u4E2A\u5B9E\u4F8B\u7684\u72B6\u6001\u4F1A\u4E00\u76F4\u662Fpadding</li><li>promise\u4E2D\u5982\u679C\u4E0D\u6307\u5B9A\u9519\u8BEF\u9ED8\u8BA4\u8FD4\u56DE\u7684\u90FD\u662Freslove\u72B6\u6001(\u76F4\u63A5throw error\u4F1A\u9000\u51FA\u6267\u884C)</li><li>promise.then .catch \u8FD9\u4E9B\u8FD4\u56DE\u7684\u4E5F\u662Fpromise,\u5982\u679C\u4E0D\u52A0\u72B6\u6001\u4E5F\u4F1A\u9ED8\u8BA4\u4E3Areslove\u72B6\u6001</li><li>\u60F3\u8981\u4E2D\u65ADpromise\u94FE\u5F0F,\u8FD4\u56DE\u7A7Apromise: new Promise(() =&gt; {})</li></ul><h2 id="\u9759\u6001\u65B9\u6CD5" tabindex="-1">\u9759\u6001\u65B9\u6CD5 <a class="header-anchor" href="#\u9759\u6001\u65B9\u6CD5" aria-hidden="true">#</a></h2><ul><li>Promise.all([promiseA, promiseB]) \u4F1A\u7B49\u5230\u8FD9\u4E9Bpromise\u5168\u90E8\u6709\u6B63\u786E\u8FD4\u56DE\u540E\u624D\u4F1A\u89E6\u53D1\u56DE\u8C03,\u5982\u679C\u5176\u4E2D\u4E00\u4E2A\u6709\u9519\u8BEF\u4F1A\u76F4\u63A5\u5F39\u51FA\u9519\u8BEF\u4FE1\u606F,\u8FD4\u56DE\u7684\u662F\u4E00\u4E2A\u6570\u7EC4,\u8BB0\u5F55\u7684\u662F\u5404\u4E2Apromise\u7684\u8FD4\u56DE</li><li>Promise.allSettled([promiseA, promiseB]) \u4F1A\u7B49\u8FD9\u4E9Bpromise\u5168\u90E8\u8FD4\u56DE\u624D\u4F1A\u89E6\u53D1\u56DE\u8C03(\u4E0D\u7BA1\u5176\u4E2D\u662F\u5426\u6709\u5931\u8D25promise),\u8FD4\u56DE\u7684\u662F\u4E00\u4E2A\u6570\u7EC4,\u8BB0\u5F55\u7684\u662F\u5404\u4E2Apromise\u7684\u72B6\u6001\u4EE5\u53CA\u8FD4\u56DE</li><li>Promise.any([promiseA, promiseB]) \u5F53\u5176\u4E2D\u7684\u4E00\u4E2A promise \u6210\u529F,\u5C31\u8FD4\u56DE\u90A3\u4E2A\u6210\u529F\u7684promise\u7684\u503C,\u90FD\u4E0D\u6210\u529F\u5219\u8FD4\u56DEundefined</li><li>Promise.race([promiseA, promiseB]) \u5F53\u5176\u4E2D\u7684\u4E00\u4E2A promise <code>\u6210\u529F\u6216\u8005\u5931\u8D25</code>,\u5C31\u8FD4\u56DE\u7B2C\u4E00\u4E2A\u5148\u6210\u529F\u6216\u8005\u5931\u8D25\u7684promise\u72B6\u6001\u4EE5\u53CA\u503C</li><li>Promise.reject \u8FD4\u56DE\u4E00\u4E2A\u72B6\u6001\u4E3A\u5931\u8D25\u7684Promise\u5BF9\u8C61</li><li>Promise.resolve \u8FD4\u56DE\u4E00\u4E2A\u72B6\u6001\u4E3A\u6210\u529F\u7684Promise\u5BF9\u8C61</li></ul><h2 id="\u624B\u5199\u7B80\u6613promise" tabindex="-1">\u624B\u5199\u7B80\u6613promise <a class="header-anchor" href="#\u624B\u5199\u7B80\u6613promise" aria-hidden="true">#</a></h2><p>\u53C2\u8003 <a href="/blog/writingcode/promise/index" rel="noreferrer">\u624B\u5199promise</a></p><h2 id="promise-\u4EFB\u52A1\u8C03\u5EA6" tabindex="-1">promise \u4EFB\u52A1\u8C03\u5EA6 <a class="header-anchor" href="#promise-\u4EFB\u52A1\u8C03\u5EA6" aria-hidden="true">#</a></h2><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Scheduler</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">constructor</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">max</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">max</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">max</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">taskList</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// \u8FD9\u91CC\u7528\u5230\u4E86 await \u7684\u95ED\u5305\u7279\u6027,\u4F7F\u5F97\u6BCF\u6B21\u6267\u884C\u7684 fun \u90FD\u662F\u6B63\u786E\u7684</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">add</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">fun</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&gt;=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">max</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">await</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">reslove</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">taskList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">reslove</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">count</span><span style="color:#89DDFF;">++</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">await</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">fun</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">count</span><span style="color:#89DDFF;">--</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">taskList</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">taskList</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">shift</span><span style="color:#F07178;">()()</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u5EF6\u8FDF\u51FD\u6570</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> sleep </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">time</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">resolve</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setTimeout</span><span style="color:#A6ACCD;">(resolve</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> time))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u540C\u65F6\u8FDB\u884C\u7684\u4EFB\u52A1\u6700\u591A2\u4E2A</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> scheduler </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Scheduler</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u6DFB\u52A0\u5F02\u6B65\u4EFB\u52A1 (\u6A21\u4EFF\u771F\u5B9E\u8BF7\u6C42\u63A5\u53E3)</span></span>
<span class="line"><span style="color:#676E95;">// time: \u4EFB\u52A1\u6267\u884C\u7684\u65F6\u95F4</span></span>
<span class="line"><span style="color:#676E95;">// val: \u53C2\u6570</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> addTask </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">time</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">val</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">scheduler</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">add</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">sleep</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">time</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">val</span><span style="color:#F07178;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">addTask</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1000</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#82AAFF;">addTask</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">500</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#82AAFF;">addTask</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">300</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#82AAFF;">addTask</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">400</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">4</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;">// 2</span></span>
<span class="line"><span style="color:#676E95;">// 3</span></span>
<span class="line"><span style="color:#676E95;">// 1</span></span>
<span class="line"><span style="color:#676E95;">// 4</span></span>
<span class="line"></span></code></pre></div>`,11),e=[o];function r(t,c,F,y,D,i){return n(),a("div",null,e)}const d=s(p,[["render",r]]);export{C as __pageData,d as default};
